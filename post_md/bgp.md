# The Internet's Road Signs are Vulnerable

*October 1, 2021* 

In April 2019, Cloudflare, one of the world’s largest web infrastructure companies, saw a large portion of its traffic through Verizon routed to DQE Communications, a small ISP in Pennsylvania, and its customer Allegheny Technologies. In a scenario Cloudflare engineers described as “routing an entire freeway down a neighborhood street”, the burst of Verizon traffic overloaded Allegheny’s infrastructure, forcing it to drop traffic coming through its network and causing disruption to major online services including Google and Amazon. 

The incident concerns the Border Gateway Protocol (BGP), a protocol that guides traffic through the world’s massive internet infrastructures. BGP controls how a cluster of computers in the same network, known as an Autonomous System (AS), communicates with other AS to find an optimal route for traffic originated in or passing through their network. This is achieved by announcements to their peers consisting of the IP addresses that their network can reach and how long it takes to get there. Each AS then calculates the optimal route given the information provided by their neighbors. 

In the Verizon incident, DQE used a misconfigured network optimizer software that announced traffic through Allegheny as “better routes” to the outside world. Verizon, DQE’s transit provider, accepted and broadcasted the illegitimate route due to the lack of a proper filter mechanism. When traffic from all over the world tried to squeeze through Allegheny’s network, the disruption happened. 

This incident is just one of the many examples of BGP route leaks. Fortunately, it was unintentional and caused relatively local disruption. Since BGP has no built-in mechanism to validate the legitimacy of route information being advertised, and each AS is managed independently, mistakes like this are common. 

However, route leaks can become a more serious security issue. BGP hijacking occurs when an adversary deliberately sends out false routing information to divert traffic to itself or a target. In 2008, for example, Pakistan attempted to block YouTube’s traffic within its border by directing a portion of YouTube’s traffic towards its state-owned telecom, causing YouTube to experience disruption globally.  More recently in 2017, Russian ISP Rostelecom hijacked the IP of several financial services, leading to speculation that the hijack was economically and politically motivated.  These incidents show that technical vulnerabilities in BGP can become a global issue, even evolving into a national security incident when state actors are involved. 

Thankfully, the private sector is actively developing technical solutions to address internet routing issues through a set of practices collectively called Mutually Agreed Norms for Routing Security (MANRS). The group advocates for several practices including:

- Coordination: Network providers should maintain 24/7 contact information in Regional Internet Registries (RIRs) to facilitate timely response when incidents occur. In the Verizon incident, DQE was delayed in their response because Cloudflare could not get in touch with their engineers in time, and Verizon did not respond at all throughout the process. 
- Global Validation: The Internet Routing Registry (IRR) provides third-party validation for routes submitted by network providers, preventing malicious or accidental announcements from being accepted.  Another relatively new validation tool is the Resource Public Key Infrastructure (RPKI), which ensures that AS can only originate IPs they are allocated to.  RPKI would have prevented BGP hijacking based on IP spoofing, such as the Pakistan Telecom attack.
- Filtering: Network providers should filter outbound routing information submitted from their customers and inbound routing information from their peers. The filter can be based on IRR and RPKI to allow only validated route information. Providers can also keep an internal database for announcements from their customers.  In Verizon’s incident, DEQ was able to propagate the misconfigured route information only because Verizon did not set up a proper filter for internal route information.

These technical solutions, while making a BGP attack meaningfully harder, are not widely adopted across the board. According to MANRS, 86.4% of routes on the internet are registered in the IRR, and only 32.5% of routes are validated in the RPKI worldwide. These numbers are even lower for the US, with only 75% registered in the IRR and 21.2% in the RPKI.  

RPKI’s adoption rate is understandably low since it only started gaining momentum 3 years ago. IRR has existed for much longer, yet a quarter of US network providers still haven’t registered their routes. One explanation may be that the market for US network providers is fragmented, with more than 1,300 ISPs operating in 2021.  The small, tier 3 ISPs that make up most of the network providers may not have enough resources to adopt the best practices. Even without the effort from smaller ISPs, however, tier 1 and tier 2 ISPs should be able to prevent most BGP issues if their routers are configured with proper IRR and RPKI filters. These large providers have the necessary resources and a greater responsibility to provide reliable connection to its customers, which makes Verizon’s lack of proper defense baffling to Cloudflare engineers, who attribute it to “sloppiness or laziness”.

Regardless of Verizon’s motivation, protecting the integrity of internet routing is a collective effort by all network providers on the internet. While the private sector has been leading the effort, the government can help in several ways. By allocating funding for smaller ISPs, the government can encourage more network providers to adhere to MANRS. The government can also address state sponsored BGP hijacking through diplomatic channels. Most importantly, the government should protect the independence of network provider associations and standard-making bodies such as the regional internet registries and MANRS, shielding them from political influences by states advocating for more government regulation in cyberspace, especially frequent cyberattack offenders such as China and Russia. 